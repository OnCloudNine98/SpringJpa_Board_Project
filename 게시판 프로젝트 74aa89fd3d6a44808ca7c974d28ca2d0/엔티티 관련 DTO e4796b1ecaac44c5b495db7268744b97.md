# ì—”í‹°í‹° ê´€ë ¨ DTO

ë³´í†µ ì—”í‹°í‹°ê°€ ë³€ê²½ë˜ë©´ API ìŠ¤í™ì´ ë³€í•˜ëŠ” ë¬¸ì œë¥¼ ëŒ€ë¹„í•˜ê¸° ìœ„í•´ DTOë¥¼ ì‚¬ìš©í•˜ê³ ëŠ” í•˜ì§€ë§Œ 
ì´ë²ˆ í”„ë¡œì íŠ¸ ì—ì„œëŠ” request, response DTO í´ë˜ìŠ¤ë¥¼ í•˜ë‚˜ë¡œ ë¬¶ì–´ 
InnerStaticClassë¡œ í•œ ë²ˆì— ê´€ë¦¬í•˜ëŠ”ë° ì‚¬ìš© ëœë‹¤.

> **Request** [DTOê°€ ìš”ì²­ ë°›ì•„ ì²˜ë¦¬]
ì£¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©ë¼ DTOì— ìš”ì²­ì´ ë“¤ì–´ ì˜¤ë©´
**ìœ íš¨ì„±ì„ ê²€ì‚¬** ë“±ì„ í•œ í›„ ì—”í‹°í‹° ê°ì²´ë¡œ ë³€í™˜í•˜ëŠ” ê¸°ëŠ¥
**Response** [DTOê°€ ì²˜ë¦¬í›„ ì‘ë‹µ/ë°˜ë‚©]
ì£¼ë¡œ ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš© ë¼
ì—”í‹°í‹° ê°ì²´ë¥¼ DTOë¡œ ë³€í™˜í•œí›„ ë‹¤ì‹œ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ë‹¬í•˜ëŠ” ì—­í• 
> 

[Entity ì™€ DTOì˜ ì—­í• ì— ë”°ë¥¸ ì°¨ì´](%E1%84%8B%E1%85%A6%E1%86%AB%E1%84%90%E1%85%B5%E1%84%90%E1%85%B5%20%E1%84%80%E1%85%AA%E1%86%AB%E1%84%85%E1%85%A7%E1%86%AB%20DTO%20e4796b1ecaac44c5b495db7268744b97/Entity%20%E1%84%8B%E1%85%AA%20DTO%E1%84%8B%E1%85%B4%20%E1%84%8B%E1%85%A7%E1%86%A8%E1%84%92%E1%85%A1%E1%86%AF%E1%84%8B%E1%85%A6%20%E1%84%84%E1%85%A1%E1%84%85%E1%85%B3%E1%86%AB%20%E1%84%8E%E1%85%A1%E1%84%8B%E1%85%B5%203d1681747c714d719d6b9b3336028c86.md)

### CommentDto.java

User ì™€ NëŒ€1 ì–‘ë°©í–¥ ê´€ê³„ , Posts ì™€ NëŒ€1 ë‹¨ë°©í–¥ ê´€ê³„

```java
public class CommentDto {
    /**
     * ëŒ“ê¸€ Service ìš”ì²­ì„ ìœ„í•œ DTO í´ë˜ìŠ¤
     */
    @Data
    @AllArgsConstructor
    @NoArgsConstructor
    @Builder
    public static class Request {
        private Long id;
        private String comment;
        private String createdDate = LocalDateTime.now().format(DateTimeFormatter.ofPattern("yyyy.MM.dd HH:mm"));
        private String modifiedDate = LocalDateTime.now().format(DateTimeFormatter.ofPattern("yyyy.MM.dd HH:mm"));
        private User user;
        private Posts posts;

        /* DTO -> Entity */
        public Comment toEntity() {
            Comment comments = Comment.builder()
                    .id(id)
                    .comment(comment)
                    .createdDate(createdDate)
                    .modifiedDate(modifiedDate)
                    .user(user)
                    .posts(posts)
                    .build();

            return comments;
        }
    }

    /**
     * ëŒ“ê¸€ ì •ë³´ë¥¼ ë¦¬í„´í•  ì‘ë‹µ(Response) í´ë˜ìŠ¤
     */
    @RequiredArgsConstructor
    @Getter
    public static class Response {
        private Long id;
        private String comment;
        private String createdDate = LocalDateTime.now().format(DateTimeFormatter.ofPattern("yyyy.MM.dd HH:mm")) ;
        private String modifiedDate = LocalDateTime.now().format(DateTimeFormatter.ofPattern("yyyy.MM.dd HH:mm"));
        private String nickname;
        private Long userId;
        private Long posts;

        /* DTO -> Entity */
        public Response(Comment comment) {
            this.id = comment.getId();
            this.comment = comment.getComment();
            this.createdDate = comment.getCreatedDate();
            this.modifiedDate = comment.getModifiedDate();
            this.nickname = comment.getUser().getNickname();
            this.userId = comment.getUser().getId();
            this.posts = comment.getPosts().getId();
        }

    }

}

```

> ë³„ë„ì˜ **Response í´ë˜ìŠ¤**ê°€ ìˆëŠ” ì´ìœ  
Entity í´ë˜ìŠ¤ë¥¼ ìƒì„±ì íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ ë°ì´í„°ë¥¼ Dtoë¡œ ë³€í™˜í•˜ì—¬ ì‘ë‹µí•¨ìœ¼ë¡œì¨
ë³„ë„ì˜ ì „ë‹¬ ê°ì²´ë¥¼ í™œìš©í•´ ì—°ê´€ê´€ê³„ë¥¼ ë§ºì€ ì—”í‹°í‹°ê°„ì˜ ë¬´í•œì°¸ì¡°ë¥¼ ë°©ì§€
> 
- `@Builer`
:  Builder Pattern ì„ ì‰½ê²Œ êµ¬í˜„ í• ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” Annotation ìœ¼ë¡œ ë‹¤ìŒì˜ íŠ¹ì§•ì´ ìˆìŒ
    1. ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ **Method Chaining ë°©ì‹**ìœ¼ë¡œ í•„ë“œë¥¼ ì„¤ì • í•  ìˆ˜ ìˆê²Œ í•´ ê°€ë…ì„±ì„ ë†‰í˜
        
        ```java
        User user = User.builder()
                        .name("John Doe")
                        .age(30)
                        .email("john.doe@example.com")
                        .build();
        ```
        
    2. í•„ìš”í•˜ì§€ ì•Šì€ í•„ë“œëŠ” ì„¤ì •í•˜ì§€ ì•Šì•„ë„ ê°€ëŠ¥í•˜ê²Œ í•˜ì—¬ ìœ ì—°í•œ ê°ì²´ë¥¼ ìƒì„±

---

### PostsDto.java

User ì™€ NëŒ€1 ë‹¨ë°©í–¥ ê´€ê³„ 

```java
public class PostsDto {
  /**
   * ê²Œì‹œê¸€ì˜ ë“±ë¡ê³¼ ìˆ˜ì •ì„ ì²˜ë¦¬í•  ìš”ì²­(Request) í´ë˜ìŠ¤
   */
  @Data
  @AllArgsConstructor
  @NoArgsConstructor
  @Builder
  public static class Request {
      private Long id;
      private String title;
      private String writer;
      private String content;
      private String  createDate , modifiedDate;
      private int view;
      private User user;

      /* Dto -> Entity */
      public Posts toEntity() {
          Posts posts = Posts.builder()
                  .id(id)
                  .title(title)
                  .writer(writer)
                  .content(content)
                  .view(0)
                  .user(user)
                  .build();

          return posts;
      }
  }

  /**
   * ê²Œì‹œê¸€ ì •ë³´ë¥¼ ë¦¬í„´í•  ì‘ë‹µ(Response) í´ë˜ìŠ¤
   */
  @Getter
  public static class Response {
      private final Long id;
      private final String title;
      private final String writer;
      private final String content;
      private final String createDate , modifiedDate;
      private final int view;
      private final Long userId;
      private final List<CommentDto.Response> comments;

      /* Entity -> Dto*/
      public Response(Posts posts) {
          this.id = posts.getId();
          this.title = posts.getTitle();
          this.writer = posts.getWriter();
          this.content = posts.getContent();
          this.createDate = posts.getCreatedDate();
          this.modifiedDate = posts.getModifiedDate();
          this.view = posts.getView();
          this.userId = posts.getUser().getId();
          this.comments = posts.getComments().stream().map(CommentDto.Response::new).collect(Collectors.toList());
      }

  }
}
```

> ë³„ë„ì˜ **Response í´ë˜ìŠ¤**ê°€ ìˆëŠ” ì´ìœ  
Entity í´ë˜ìŠ¤ë¥¼ ìƒì„±ì íŒŒë¼ë¯¸í„°ë¡œ ë°›ì•„ ë°ì´í„°ë¥¼ Dtoë¡œ ë³€í™˜í•˜ì—¬ ì‘ë‹µí•¨ìœ¼ë¡œì¨
ë³„ë„ì˜ ì „ë‹¬ ê°ì²´ë¥¼ í™œìš©í•´ ì—°ê´€ê´€ê³„ë¥¼ ë§ºì€ ì—”í‹°í‹°ê°„ì˜ ë¬´í•œì°¸ì¡°ë¥¼ ë°©ì§€
> 
- `@NoArgsConstructor`
:  íŒŒë¼ë¯¸í„°ê°€ **ì—†ëŠ”** ê¸°ë³¸ ìƒì„±ìë¥¼ ìë™ìœ¼ë¡œ ìƒì„±
- `@AllArgsConstructor`
: Lombok ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì œê³µí•˜ëŠ” Annotationìœ¼ë¡œ 
í´ë˜ìŠ¤ì˜ **ëª¨ë“  í•„ë“œ**ë¥¼ ì¸ìˆ˜ë¡œ ê°–ëŠ” ìƒì„±ìë¥¼ ìë™ìœ¼ë¡œ ìƒì„±

---

### UserDto.java

```java
public class UserDto {

    /**
     * íšŒì› Service ìš”ì²­(Request) DTO í´ë˜ìŠ¤
     */
    @Data
    @AllArgsConstructor
    @NoArgsConstructor
    @Builder
    public static class Request {
        private Long id;

        @Pattern(regexp = "^[ã„±-ã…ê°€-í£a-z0-9-_]{4,20}$",message = "ì•„ì´ë””ëŠ” íŠ¹ìˆ˜ë¬¸ìë¥¼ ì œì™¸í•œ 4~20ìë¦¬ ì—¬ì•¼ í•©ë‹ˆë‹¤.")
        @NotBlank(message = "ì•„ì´ë””ëŠ” í•„ìˆ˜ ì…ë ¥ ê°’ì…ë‹ˆë‹¤.")
        private String username;

        @Pattern(regexp = "(?=.*[0-9])(?=.*[a-zA-Z])(?=.*\\W)(?=\\S+$).{8,16}" , message = "ë¹„ë°€ë²ˆí˜¸ëŠ” 8~16ìì˜ ì˜ë¬¸ ëŒ€ ì†Œë¬¸ì, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.")
        private String password;

        @Pattern(regexp = "^[ã„±-ã…ê°€-í£a-zA-Z0-9-_]{2,10}$" ,message = "ë‹‰ë„¤ì„ì€ íŠ¹ìˆ˜ë¬¸ìë¥¼ ì œì™¸í•œ 2~10ìë¦¬ ì—¬ì•¼ í•©ë‹ˆë‹¤.")
        @NotBlank(message = "ë‹‰ë„¤ì„ì€ í•„ìˆ˜ ì…ë ¥ ê°’ì…ë‹ˆë‹¤.")
        private String nickname;

        @Pattern(regexp = "^(?:\\w+\\.?)*\\w+@(?:\\w+\\.)+\\w+$" ,message = "ì´ë©”ì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.")
        @NotBlank(message = "ì´ë©”ì¼ì€ í•„ìˆ˜ ì…ë ¥ ê°’ì…ë‹ˆë‹¤.")
        private String email;

        private Role role;

        /* DTO -> Entity */
        public User toEntity() {
            User user = User.builder()
                    .id(id)
                    .username(username)
                    .password(password)
                    .nickname(nickname)
                    .email(email)
                    .role(role.USER)
                    .build();

            return user;
        }
    }

    /**
     * ì¸ì¦ëœ ì‚¬ìš©ì ì •ë³´ë¥¼ ì„¸ì…˜ì— ì €ì¥í•˜ê¸° ìœ„í•œ í´ë˜ìŠ¤
     */
    @Getter
    public static class Response implements Serializable {
        private final Long id;
        private final String username;
        private final String nickname;
        private final String email;
        private final Role role;
        private final String modifiedDate;

        /* Entity -> dto */
        public Response(User user) {
            this.id = user.getId();
            this.username = user.getUsername();
            this.nickname = user.getNickname();
            this.email = user.getEmail();
            this.role = user.getRole();
            this.modifiedDate = user.getModifiedDate();
        }

    }

}
```

> UserDto ì˜ Response ëŠ” ì„¸ì…˜ê³¼ ì—°ê´€ì´ ìˆë‹¤.
ì„¸ì…˜ì„ ì €ì¥í•˜ê¸° ìœ„í•´ User ì—”í‹°í‹° í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ **ì§ë ¬í™”**ë¥¼ í•´ì•¼ í•˜ëŠ”ë°,
ì—”í‹°í‹° í´ë˜ìŠ¤ì— **ì§ë ¬í™”**ë¥¼ ë„£ì–´ì£¼ë©´ ì¶”í›„ ë‹¤ë¥¸ ì—”í‹°í‹°ì™€ ì—°ê´€ê´€ê³„ë¥¼ ë§ºì„ì‹œ **ì§ë ¬í™” ëŒ€ìƒ**ì— ë‹¤ë¥¸ ì—”í‹°í‹°ê¹Œì§€ í¬í•¨ë  ìˆ˜ ìˆì–´ ì„±ëŠ¥ ì´ìŠˆ ìƒê²¨ ì„¸ì…˜ ì €ì¥ìš© Dto í´ë˜ìŠ¤ ìƒì„±í•œë‹¤.
> 

<aside>
ğŸ’¡ **ì§ë ¬í™”?**
ê°ì²´ì˜ ìƒíƒœë¥¼ **bite stream** ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥í•˜ê±°ë‚˜ ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ì „ì†¡í•  ìˆ˜ 
ìˆë„ë¡ í•˜ëŠ” ê³¼ì •

</aside>

- `@JoinColumn`
: JPAì—ì„œ ì‚¬ìš© ë˜ëŠ” Annotationìœ¼ë¡œ ë‘ Entity ê°„ì˜ ê´€ê³„ë¥¼ ì •ì˜ í•  ë•Œ ì‚¬ìš© ë˜ë©° 
Foreign Key ë¡œì„œ **ì°¸ì¡°**ë˜ëŠ” Column ì„ ì§€ì •í•  ë•Œ ì‚¬ìš©.
    - ì£¼ìš” ì†ì„±
        - Name : í˜„ì¬ ì—”í‹°í‹°ì˜ ì™¸ë˜ í‚¤ ì—´ ì´ë¦„ì„ ì§€ì •
        - ReferencedColumnName : ì°¸ì¡°ë˜ëŠ” ì—”í‹°í‹°ì˜ ê¸°ë³¸ í‚¤ ì—´ ì´ë¦„ì„ ì§€ì •
        - Nullable : ì™¸ë˜ í‚¤ê°€ `NULL` ê°’ì„ ê°€ì§ˆ ìˆ˜ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ì§€ì •
        - Insertable / Updatable : ì™¸ë˜ í‚¤ ì—´ì´ ì‚½ì… / ìˆ˜ì • ë ìˆ˜ ìˆëŠ”ì§€ ì—¬ì£¼ë¥¼ ì§€ì •
        - Unique : ì™¸ë˜ í‚¤ ì—´ì´ ìœ ë‹ˆí¬í•œì§€ ì—¬ë¶€ë¥¼ ì§€ì •
        - ColumnDefinition : ë°ì´í„°ë² ì´ìŠ¤ì˜ ì—´ ì •ì˜ë¥¼ ì§ì ‘ ì§€ì •
- `@Enumerated`
: JAVA enum íƒ€ì…ì„ ë§¤í•‘í•  ë•Œ ì‚¬ìš©.
    - ì£¼ìš” ì†ì„±
        - `EnumType.ORDINAL` : enum ìˆœì„œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥
        - `EnumType.STRING` : enum ì´ë¦„ì„ ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥

---

### @LoginUser

```java
@Target(ElementType.PARAMETER) // íŒŒë¼ë¯¸í„°ë¡œ ì„ ì–¸ëœ ê°ì²´ë§Œ ì‚¬ìš©
@Retention(RetentionPolicy.RUNTIME) //ëŸ°íƒ€ì„ ê¹Œì§€ ë‚¨ì•„ìˆìŒ.
public @interface LoginUser {
}
```

> í”„ë¡œì íŠ¸ë¥¼ ì‚´í´ ë³´ë©´ ì‚¬ìš©ì(User) ì˜ ë¡œê·¸ì¸ì€ ì„¸ì…˜ê³¼ ì—°ê´€ì´ ìˆëŠ”ë° ì´ë•Œ 
ì„¸ì…˜ê³¼ ê´€ë ¨í•˜ì—¬ ì¤‘ë³µì½”ë“œë¥¼ ì¤„ì—¬ì£¼ê¸° ìœ„í•´ LoginUser  Annotationì„ ìƒì„±í•˜ì—¬ ì ‘ê·¼
> 

---